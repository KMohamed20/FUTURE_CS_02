from dataclasses import dataclass
from typing import List, Dict, Optional
from datetime import datetime

@dataclass
class ThreatIndicator:
    ioc_type: str
    value: str
    confidence: float
    source: str
    timestamp: datetime
    description: str

@dataclass
class SecurityIncident:
    id: str
    type: str
    severity: str
    confidence: float
    source_ips: List[str]
    affected_assets: List[str]
    indicators: List[ThreatIndicator]
    timeline: List[Dict]
    mitigation_steps: List[str]
    timestamp: datetime
    status: str = "open"
